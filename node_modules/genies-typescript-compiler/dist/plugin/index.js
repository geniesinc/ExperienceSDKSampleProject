!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports["genies-typescript-compiler-plugin"]=t():e["genies-typescript-compiler-plugin"]=t()}(this,(()=>(()=>{"use strict";var e={26:(e,t,n)=>{const i=n(710),r=n(741),o=n(54),s=n(830),a=n(400),l=n(335),c=n(865),u=n(71);e.exports=e=>{let t,n;return{create:function(e){e.project.projectService.logger.info("I'm getting set up now! Check the log for this message."),t=new i.Project({compilerOptions:e.project.getCompilerOptions(),skipAddingFilesFromTsConfig:!0}),(0,u.setProjectRoot)(t.getFileSystem().getCurrentDirectory()),n=new l.GeniesLSPContext(t,e);const g=[new r.GeniesLifecycleEventsCompletions(n),new o.CSharpOperatorOverloadingSuppress(n),new s.GeniesLifecycleEventsDiagnostics(n),new a.GeniesScriptTypeDiagnostics(n),new c.GeniesSemanticDiagnostics(n)],d=Object.create(null);for(const t of Object.keys(e.languageService)){const n=e.languageService[t];d[t]=(...t)=>n.apply(e.languageService,t)}return g.forEach((e=>e.enhanceProxy(d))),d}}}},54:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CSharpOperatorOverloadingSuppress=void 0;const i=n(710),r=n(130);class o{constructor(e){this.expressionValidity=[],this.context=e}get Logger(){return this.context.Logger}enhanceProxy(e){const t=e.getSemanticDiagnostics;e.getSemanticDiagnostics=e=>this.getSemanticDiagnostics(t,e)}getSemanticDiagnostics(e,t){const n=e(t),i=this.context.getSourceFile(t);if(!i)return n;this.collectExpressions(i);const r=n.filter((e=>{if(void 0===e.start||void 0===e.length)return!0;const t=e.start,n=t+e.length,i=e.code;if(!o.OPERATOR_ERROR_CODES.includes(Number(i)))return!0;for(const e of this.expressionValidity)if(e.valid&&t>=e.start&&n<=e.end)return!1;return!0}));return this.expressionValidity=[],r}collectExpressions(e){var t;const n=e.getDescendantsOfKind(i.SyntaxKind.BinaryExpression),o=e.getDescendantsOfKind(i.SyntaxKind.PrefixUnaryExpression),s=e.getDescendantsOfKind(i.SyntaxKind.PostfixUnaryExpression),a=e=>{const t=e.getStart(),n=e.getEnd(),i=(0,r.getOperatorNodeReturnType)(e,this.context),o=null!=i;this.context.Logger.info(`[FOUND TYPE] ${null==i?void 0:i.getText()} at Node ${e.getText()}`),this.expressionValidity.push({start:t,end:n,valid:o})};n.forEach(a),o.forEach(a),s.forEach(a);const l=n.filter((e=>e.getOperatorToken().getKind()===i.SyntaxKind.EqualsToken));for(const e of l){const t=e.getRight(),n=t.getStart(),i=t.getEnd();this.expressionValidity.some((e=>e.valid&&e.start<=n&&e.end>=i))&&this.expressionValidity.push({start:e.getStart(),end:e.getEnd(),valid:!0})}const c=e.getDescendantsOfKind(i.SyntaxKind.VariableDeclaration);for(const e of c){const t=e.getInitializer();if(!t)continue;const n=t.getStart(),i=t.getEnd();this.expressionValidity.some((e=>e.valid&&e.start<=n&&e.end>=i))&&this.expressionValidity.push({start:e.getStart(),end:e.getEnd(),valid:!0})}const u=e.getDescendantsOfKind(i.SyntaxKind.AsExpression);for(const e of u){const n=e.getExpression(),i=n.getStart(),o=n.getEnd();if(!this.expressionValidity.some((e=>e.valid&&e.start<=i&&e.end>=o)))continue;const s=null!==(t=(0,r.getOperatorNodeReturnType)(n,this.context))&&void 0!==t?t:this.context.TypeChecker.getTypeAtLocation(n),a=this.context.TypeChecker.getTypeAtLocation(e.getTypeNodeOrThrow());s.isAssignableTo(a)&&this.expressionValidity.push({start:e.getStart(),end:e.getEnd(),valid:!0})}}}t.CSharpOperatorOverloadingSuppress=o,o.OPERATOR_ERROR_CODES=[2365,2363,2362,2322,2345,2352,2315]},60:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ScriptableObjectAllowedMethods=t.unityLifecycleMethods=void 0,t.unityLifecycleMethods=[{name:"Awake",parameters:"",description:"Called when the script instance is being loaded.",imports:[]},{name:"Start",parameters:"",description:"Called before the first frame update.",imports:[]},{name:"OnEnable",parameters:"",description:"Called when the object becomes enabled and active.",imports:[]},{name:"OnDisable",parameters:"",description:"Called when the object becomes disabled.",imports:[]},{name:"OnDestroy",parameters:"",description:"Called when the MonoBehaviour will be destroyed.",imports:[]},{name:"Update",parameters:"",description:"Called once per frame.",imports:[]},{name:"FixedUpdate",parameters:"",description:"Called every fixed frame-rate frame.",imports:[]},{name:"LateUpdate",parameters:"",description:"Called once per frame after Update.",imports:[]},{name:"OnCollisionEnter",parameters:"collision: Collision",description:"Called when this collider/rigidbody has begun touching another rigidbody/collider.",imports:[{type:"Collision",module:"UnityEngine"}]},{name:"OnCollisionExit",parameters:"collision: Collision",description:"Called when this collider/rigidbody has stopped touching another rigidbody/collider.",imports:[{type:"Collision",module:"UnityEngine"}]},{name:"OnCollisionStay",parameters:"collision: Collision",description:"Called once per frame for every collider/rigidbody that is touching rigidbody/collider.",imports:[{type:"Collision",module:"UnityEngine"}]},{name:"OnCollisionEnter2D",parameters:"collision: Collision2D",description:"Called when this collider/rigidbody has begun touching another rigidbody/collider in 2D.",imports:[{type:"Collision2D",module:"UnityEngine"}]},{name:"OnCollisionExit2D",parameters:"collision: Collision2D",description:"Called when this collider/rigidbody has stopped touching another rigidbody/collider in 2D.",imports:[{type:"Collision2D",module:"UnityEngine"}]},{name:"OnCollisionStay2D",parameters:"collision: Collision2D",description:"Called once per frame for every collider/rigidbody that is touching rigidbody/collider in 2D.",imports:[{type:"Collision2D",module:"UnityEngine"}]},{name:"OnTriggerEnter",parameters:"other: Collider",description:"Called when the Collider other enters the trigger.",imports:[{type:"Collider",module:"UnityEngine"}]},{name:"OnTriggerExit",parameters:"other: Collider",description:"Called when the Collider other has stopped touching the trigger.",imports:[{type:"Collider",module:"UnityEngine"}]},{name:"OnTriggerStay",parameters:"other: Collider",description:"Called once per frame for every Collider other that is touching the trigger.",imports:[{type:"Collider",module:"UnityEngine"}]},{name:"OnTriggerEnter2D",parameters:"other: Collider2D",description:"Called when the Collider other enters the trigger in 2D.",imports:[{type:"Collider2D",module:"UnityEngine"}]},{name:"OnTriggerExit2D",parameters:"other: Collider2D",description:"Called when the Collider other has stopped touching the trigger in 2D.",imports:[{type:"Collider2D",module:"UnityEngine"}]},{name:"OnTriggerStay2D",parameters:"other: Collider2D",description:"Called once per frame for every Collider other that is touching the trigger in 2D.",imports:[{type:"Collider2D",module:"UnityEngine"}]},{name:"OnControllerColliderHit",parameters:"hit: ControllerColliderHit",description:"Called when the character controller hits a collider while performing a move.",imports:[{type:"ControllerColliderHit",module:"UnityEngine"}]},{name:"OnGUI",parameters:"",description:"Called for rendering and handling GUI events.",imports:[]},{name:"OnMouseDown",parameters:"",description:"Called when the user has pressed the mouse button while over the GUIElement or Collider.",imports:[]},{name:"OnMouseDrag",parameters:"",description:"Called when the user has clicked on a GUIElement or Collider and is still holding down the mouse.",imports:[]},{name:"OnMouseUp",parameters:"",description:"Called when the user has released the mouse button.",imports:[]},{name:"OnMouseEnter",parameters:"",description:"Called when the mouse enters the GUIElement or Collider.",imports:[]},{name:"OnMouseExit",parameters:"",description:"Called when the mouse is not any longer over the GUIElement or Collider.",imports:[]},{name:"OnMouseOver",parameters:"",description:"Called every frame while the mouse is over the GUIElement or Collider.",imports:[]},{name:"OnMouseUpAsButton",parameters:"",description:"Called when the user has pressed the mouse button while over the GUIElement or Collider and is still holding down the mouse.",imports:[]},{name:"OnApplicationFocus",parameters:"hasFocus: boolean",description:"Called when the application gains or loses focus.",imports:[]},{name:"OnApplicationPause",parameters:"pauseStatus: boolean",description:"Called when the application is paused or resumed.",imports:[]},{name:"OnApplicationQuit",parameters:"",description:"Called when the application is about to quit.",imports:[]},{name:"OnPreRender",parameters:"",description:"Called before a camera starts rendering the scene.",imports:[]},{name:"OnPostRender",parameters:"",description:"Called after a camera has finished rendering the scene.",imports:[]},{name:"OnRenderImage",parameters:"source: RenderTexture, destination: RenderTexture",description:"Called after all rendering is complete to render image.",imports:[{type:"RenderTexture",module:"UnityEngine"}]},{name:"OnRenderObject",parameters:"",description:"Called after camera has rendered the scene.",imports:[]},{name:"OnWillRenderObject",parameters:"",description:"Called once for each camera if the object is visible.",imports:[]},{name:"OnPreCull",parameters:"",description:"Called before the camera culls the scene.",imports:[]},{name:"OnAnimatorIK",parameters:"layerIndex: number",description:"Called right after the Animator has performed IK pass.",imports:[]},{name:"OnAnimatorMove",parameters:"",description:"Called right after the Animator updates.",imports:[]},{name:"OnDrawGizmos",parameters:"",description:"Called when the editor draws gizmos.",imports:[]},{name:"OnValidate",parameters:"",description:"Called when the script is loaded or a value is changed in the inspector.",imports:[]},{name:"OnExperiencePaused",parameters:"",description:"Called when the experience is paused.",imports:[]},{name:"OnExperienceResumed",parameters:"",description:"Called when the experience is resumed.",imports:[]},{name:"OnExperienceQuit",parameters:"",description:"Called when the experience is quit.",imports:[]}],t.ScriptableObjectAllowedMethods=["Awake","OnEnable","OnDisable","OnDestroy","OnValidate","OnApplicationFocus","OnApplicationPause","OnApplicationQuit","OnExperiencePaused","OnExperienceResumed","OnExperienceQuit"]},71:function(e,t,n){var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,r)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),r=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return r(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.updateImportsToAliasPaths=t.convertToAliasPath=t.convertToGeniesAliasPath=t.isGeniesScriptType=t.getGeniesScriptTypeFromType=t.getIsUnityAPIDeclaration=t.isAssignmentToSymbol=t.cleanTypeText=t.getTypeByName=t.getIsUnityAPIType=t.isUserDefinedType=t.getIsValidUnityGenericTypeArg=t.getCompleteTypeArgumentMap=t.extractProperties=t.getFullTypeName=t.getTypeNameAndEnsureImported=t.getTypeName=t.getGenericTypeKey=t.createGenericTypeVariable=t.sortImportsAndVars=t.getBaseTypes=t.inheritsFrom=t.isOrInheritsFromGameObjectOrComponent=t.isTypeAssignableTo=t.typesAreEqual=t.isOrInheritsFromObject=t.isGeniesEventType=t.isSignalBusType=t.traversePrototypeChain=t.traversePostOrder=t.collectNodes=t.removeDecorators=t.extendsScriptableObject=t.extendsMonoBehaviour=t.setProjectRoot=t.GeniesScriptType=t.NumericalAliases=t.UiInterfaceToEnumMap=t.AllowedUiInterfaces=t.GeniesScriptUiEvents=t.componentMethods=t.SET_ITEM_NAME=t.GET_ITEM_NAME=t.SerializeFieldDecorator=t.NonSerializedDecorator=t.ScriptableObjectTypeName=t.MonobehaviourTypeName=t.GeniesInstancePropName=t.GeniesDeclarationFileAnnotation=t.projectRoot=void 0;const s=n(710),a=o(n(928)),l=new Map;var c;t.projectRoot="",t.GeniesDeclarationFileAnnotation="//@Genies-UnityApiInterface",t.GeniesInstancePropName="__geniesInstance__",t.MonobehaviourTypeName="MonoBehaviour",t.ScriptableObjectTypeName="ScriptableObject",t.NonSerializedDecorator="NonSerialized",t.SerializeFieldDecorator="SerializeField",t.GET_ITEM_NAME="get_Item",t.SET_ITEM_NAME="set_Item",t.componentMethods=new Set(["GetComponent","TryGetComponent","GetComponentInChildren","GetComponentsInChildren","GetComponentInParent","GetComponentsInParent","GetComponents","AddComponent"]),function(e){e[e.None=0]="None",e[e.PointerClick=1]="PointerClick",e[e.PointerDown=2]="PointerDown",e[e.PointerEnter=4]="PointerEnter",e[e.PointerExit=8]="PointerExit",e[e.PointerUp=16]="PointerUp",e[e.BeginDrag=32]="BeginDrag",e[e.Deselect=64]="Deselect",e[e.Drag=128]="Drag",e[e.Drop=256]="Drop",e[e.EndDrag=512]="EndDrag",e[e.InitializePotentialDrag=1024]="InitializePotentialDrag",e[e.Scroll=2048]="Scroll",e[e.Select=4096]="Select",e[e.Submit=8192]="Submit",e[e.UpdateSelected=16384]="UpdateSelected",e[e.Move=32768]="Move",e[e.Cancel=65536]="Cancel"}(c||(t.GeniesScriptUiEvents=c={})),t.AllowedUiInterfaces=new Set(["UnityEngine.EventSystems.IPointerClickHandler","UnityEngine.EventSystems.IPointerDownHandler","UnityEngine.EventSystems.IPointerEnterHandler","UnityEngine.EventSystems.IPointerExitHandler","UnityEngine.EventSystems.IPointerUpHandler","UnityEngine.EventSystems.IBeginDragHandler","UnityEngine.EventSystems.IDeselectHandler","UnityEngine.EventSystems.IDragHandler","UnityEngine.EventSystems.IDropHandler","UnityEngine.EventSystems.IEndDragHandler","UnityEngine.EventSystems.IInitializePotentialDragHandler","UnityEngine.EventSystems.IScrollHandler","UnityEngine.EventSystems.ISelectHandler","UnityEngine.EventSystems.ISubmitHandler","UnityEngine.EventSystems.IUpdateSelectedHandler","UnityEngine.EventSystems.IMoveHandler","UnityEngine.EventSystems.ICancelHandler"]),t.UiInterfaceToEnumMap=new Map([["UnityEngine.EventSystems.IPointerClickHandler",c.PointerClick],["UnityEngine.EventSystems.IPointerDownHandler",c.PointerDown],["UnityEngine.EventSystems.IPointerEnterHandler",c.PointerEnter],["UnityEngine.EventSystems.IPointerExitHandler",c.PointerExit],["UnityEngine.EventSystems.IPointerUpHandler",c.PointerUp],["UnityEngine.EventSystems.IBeginDragHandler",c.BeginDrag],["UnityEngine.EventSystems.IDeselectHandler",c.Deselect],["UnityEngine.EventSystems.IDragHandler",c.Drag],["UnityEngine.EventSystems.IDropHandler",c.Drop],["UnityEngine.EventSystems.IEndDragHandler",c.EndDrag],["UnityEngine.EventSystems.IInitializePotentialDragHandler",c.InitializePotentialDrag],["UnityEngine.EventSystems.IScrollHandler",c.Scroll],["UnityEngine.EventSystems.ISelectHandler",c.Select],["UnityEngine.EventSystems.ISubmitHandler",c.Submit],["UnityEngine.EventSystems.IUpdateSelectedHandler",c.UpdateSelected],["UnityEngine.EventSystems.IMoveHandler",c.Move],["UnityEngine.EventSystems.ICancelHandler",c.Cancel]]);const u=new Map([["float","Single"],["int","Int32"],["double","Double"],["long","Int64"],["ulong","UInt64"],["bool","Boolean"],["string","String"],["number","Double"],["short","Int16"],["ushort","UInt16"],["byte","Byte"],["sbyte","SByte"],["uint","UInt32"],["char","Char"],["any","Object"]]),g=new Map([["float","System.Single"],["int","System.Int32"],["double","System.Double"],["long","System.Int64"],["ulong","System.UInt64"],["bool","System.Boolean"],["string","System.String"],["number","System.Double"],["short","System.Int16"],["ushort","System.UInt16"],["byte","System.Byte"],["sbyte","System.SByte"],["uint","System.UInt32"],["char","System.Char"],["any","System.Object"]]);var d;function p(e){let t=e.getBaseClass();for(;t;){if("MonoBehaviour"===t.getName())return!0;t=t.getBaseClass()}return!1}function m(e){let t=e.getBaseClass();for(;t;){if("ScriptableObject"===t.getName())return!0;t=t.getBaseClass()}return!1}function y(e,t){return e===t||K(e.getText())===K(t.getText())}function h(e,t,n){var i;const r=f(e,n);for(const e of r){const r=null===(i=e.getSymbol())||void 0===i?void 0:i.getName();if(r&&t.includes(r))return!0;if(h(e,t,n))return!0}return!1}function f(e,t,n=new Set){const i=[],r=e.getSymbol();if(!r)return i;const o=r.getDeclarations();if(!o)return i;for(const e of o)if(s.Node.isClassDeclaration(e)){const r=e.getHeritageClauses();for(const e of r){const r=e.getTypeNodes();for(const e of r){const r=t.getTypeAtLocation(e);r&&!n.has(r)&&(n.add(r),i.push(r),i.push(...f(r,t,n)))}}}return i}function T(e,t){return`${S(e)}$${t.map((e=>{const t=e.getTypeArguments();return t.length>0?T(e,t):S(e)})).join("$")}`}function S(e){var t,n;return null!==(n=null===(t=e.getSymbol())||void 0===t?void 0:t.getName())&&void 0!==n?n:e.getText()}function E(e,t){let n=S(e),i="",r="";if(u.has(n)){let e=n;n=u.get(e),r="System"}else{const t=G(e);if(t!==d.None)switch(t){case d.Monobehaviour:n="MonoBehaviour",r="UnityEngine";break;case d.ScriptableObject:n="ScriptableObject",r="UnityEngine"}else{if(!k(e))throw new Error("Can't use non CSharp types");{i=x(e,!0,!1);const t=i.lastIndexOf(".");r=i.substring(0,t)}}}const o=t.getImportDeclarations().find((e=>e.getModuleSpecifierValue()===r));if(o)o.getNamedImports().some((e=>e.getName()===n))||o.addNamedImport(n);else{const e={kind:s.StructureKind.ImportDeclaration,moduleSpecifier:r,namedImports:[{name:n}]};t.addImportDeclaration(e)}return n}function x(e,n=!0,i=!0){let r="";const o=e.getAliasSymbol();if(r=o?o.getName():e.getText(),g.has(r))return g.get(r);const l=e.getSymbol();if(!l)return r;if(k(e))r=l.getFullyQualifiedName().replace(/['"]/g,"");else{const e=l.getDeclarations();let n=!1;if(e.forEach((e=>{(s.Node.isInterfaceDeclaration(e)||s.Node.isClassDeclaration(e))&&(n=e.isExported())})),!n&&e.length>0){const n=e[0].getSourceFile().getFilePath(),i=j(t.projectRoot,n),o=a.parse(i),s=a.join(o.dir,o.name);r=`${s}.${l.getFullyQualifiedName().replace(/['"]/g,"")}`}else r=l.getFullyQualifiedName().replace(/['"]/g,"");const i=a.parse(r);if(""!==i.dir||""!==i.root){let e=w(r);null!=e&&(r=e)}}const c=/\$(\d+)$/;if(n&&c.test(r)&&(r=r.replace(c,((e,t)=>"`"+t)),i)){const t=e.getTypeArguments();t.length>0&&(r+="<",t.forEach(((e,n)=>{let i=x(e);r+=i,n<t.length-1&&(r+=", ")})),r+=">")}return r}function b(e,t){return e.map((e=>{const n=Object.assign({},e);return n.Path=`${t}.${e.Name}`,n.ChildProperties&&n.ChildProperties.length>0&&(n.ChildProperties=b(n.ChildProperties,n.Path)),n}))}function v(e,n="",i=new Map){const r=e.getName()||"",o=`${e.getSourceFile().getFilePath()}|${r}|${e.getTypeParameters().map((e=>e.getName())).join(",")}|${Array.from(i.entries()).map((([e,t])=>{let n="";const i=t.getTypeArguments();return n=(null==i?void 0:i.length)>0?T(t,i):x(t),`${e}:${n}`})).join(",")}`;if(l.has(o)){const e=l.get(o);return n?e.map((e=>{const t=Object.assign({},e);return t.Path=n?`${n}.${e.Name}`:e.Name,t.ChildProperties&&t.ChildProperties.length>0&&(t.ChildProperties=b(t.ChildProperties,t.Path)),t})):e}const a=[];return e.getProperties().forEach((e=>{const r=e.getScope(),o=_(e);if(e.isStatic()||e.isReadonly())return;if("private"===r&&!o.some((e=>e.Type===t.SerializeFieldDecorator)))return;if("public"===r&&o.some((e=>e.Type===t.NonSerializedDecorator)))return;const l=I(e.getType(),i),c=l.isArray(),u=A(l,i),g=x(u),d=e.getName();let p=n?`${n}.${d}`:d;function m(e){if(e.getKind()===s.SyntaxKind.NewExpression){const t=e;return`new ${x(t.getType())}(${t.getArguments().map((e=>e.getText())).join(", ")});`}if(e.getKind()===s.SyntaxKind.PropertyAccessExpression){const t=e;return`${x(t.getExpression().getType())}.${t.getName()}`}return e.getKind()===s.SyntaxKind.StringLiteral?e.getLiteralValue():e.getText()}const y=[];if(e.hasInitializer()){const t=e.getInitializer();if(t)if(t.getKind()===s.SyntaxKind.ArrayLiteralExpression){const e=t;for(let t=0;t<e.getElements().length;t++){const n=e.getElements()[t];y.push(m(n))}}else y.push(m(t))}const h={Path:p,Name:d,TypeName:g,ChildProperties:[],IsArray:c,IsEnum:!1,EnumKeys:[],EnumValues:[],Decorators:_(e),IsGeniesBehaviourRef:!1,IsGeniesScriptableObjectRef:!1,Initializers:y,ArrayElementInitializer:void 0,ArrayDimension:-1};if(c){let e=1;return h.ArrayElementInitializer=D(l,g,d,p,e,i),h.ArrayDimension=e,void a.push(h)}C(u,h,i),a.push(h)})),l.set(o,a),a}function C(e,t,n){const i=e.isEnum(),r=e.getSymbol()||e.getAliasSymbol();if(!r)return;const o=r.getDeclarations()[0],a=M(o),l=U(o,a);if(t.IsGeniesBehaviourRef=l==d.Monobehaviour,t.IsGeniesScriptableObjectRef=l==d.ScriptableObject,!a&&l===d.None&&(i&&function(e,t){const{keys:n,values:i}=function(e){const t=e.getSymbol(),n=null==t?void 0:t.getDeclarations().find((e=>e.getKind()===s.SyntaxKind.EnumDeclaration));return n?{keys:n.getMembers().map((e=>e.getName())),values:n.getMembers().map((e=>e.getValue()))}:{keys:[],values:[]}}(t);e.EnumKeys=n,e.EnumValues=i.map((e=>void 0===e?"":e.toString())),e.IsEnum=!0}(t,e),r.getDeclarations().some((e=>s.Node.isClassDeclaration(e))))){const i=r.getDeclarations().find(s.Node.isClassDeclaration),o=i.getTypeParameters(),a=e.getTypeArguments();o.forEach(((e,t)=>{const r=`${e.getName()}_${i.getName()}`;n.set(r,a[t])})),n=P(i,n);const l=[];let c=i;for(;c;){l.unshift(...v(c,t.Path,n));let e=c.getBaseClass();if(void 0===e)break;c=e}t.ChildProperties=l}}function D(e,t,n,i,r,o){let s=e.isArray()?e.getArrayElementType():e;s.isArray()||(s=A(s,o));let a=r;const l={Path:i+"_D"+r,Name:n,TypeName:t,ArrayDimension:r,ChildProperties:[],IsArray:s.isArray(),IsEnum:s.isEnum(),EnumKeys:[],EnumValues:[],Decorators:[],IsGeniesBehaviourRef:!1,IsGeniesScriptableObjectRef:!1,Initializers:[],ArrayElementInitializer:void 0};return s.isArray()?l.ArrayElementInitializer=D(s,t,n,i,++a,o):C(s,l,o),l}function P(e,t){return N(e,t),t}function N(e,t){const n=e.getBaseClass();if(!n)return;const i=e.getHeritageClauseByKind(s.SyntaxKind.ExtendsKeyword);if(!i)return;const r=i.getTypeNodes();if(0===r.length)return;const o=r[0].getTypeArguments(),a=n.getTypeParameters(),l=e.getBaseTypes()[0];if(l){const e=l.getTypeArguments();a.forEach(((i,r)=>{if(r<e.length){const o=`${i.getName()}_${n.getName()||""}`;t.set(o,e[r]);const a=e[r];if(a.isTypeParameter()){const e=a.getSymbol();if(e){const n=e.getDeclarations();if(n&&n.length>0){const i=n[0];if(s.Node.isTypeParameterDeclaration(i)){const n=i.getParent();if(s.Node.isClassDeclaration(n)||s.Node.isInterfaceDeclaration(n)){const i=n.getName()||"",r=`${e.getName()}_${i}`;t.has(r)&&t.set(o,t.get(r))}}}}}}}))}else o.length>0&&a.forEach(((i,r)=>{if(r>=o.length)return;const a=`${i.getName()}_${n.getName()||""}`,l=o[r];if(l.getKind()===s.SyntaxKind.TypeReference){const n=l.getTypeName();if(s.Node.isIdentifier(n)){const i=`${n.getText()}_${e.getName()||""}`;t.has(i)&&t.set(a,t.get(i))}}else{const e=l.getType();t.set(a,e)}}));N(n,t)}function I(e,t){var n,i;let r=e;if(r.isTypeParameter()){const e=null===(n=r.getSymbol())||void 0===n?void 0:n.getName(),o=null===(i=r.getSymbol())||void 0===i?void 0:i.getDeclarations()[0].getParent(),a=`${e}_${o&&s.Node.isClassDeclaration(o)?o.getName():""}`;a&&t.has(a)&&(r=t.get(a))}return r}function A(e,t){let n=e;for(;null==n?void 0:n.isArray();)n=n.getArrayElementType();return n=I(n,t),n}function O(e){if(!e)return!1;const n=e.getFirstChild();if(!n)return console.log("No nodes found in the file."),!1;const i=n.getLeadingCommentRanges();return i.length>0&&i[0].getText()===t.GeniesDeclarationFileAnnotation}function k(e){let t=e.getSymbol();if(!t)return!1;const n=t.getDeclarations();return!(!n||0===n.length)&&O(n[0].getSourceFile())}function K(e){return e.replace(/&\s*\{[^}]*\}/,"").trim()}function M(e){return O(e.getSourceFile())}function U(e,t){if(e.getKind()!==s.SyntaxKind.ClassDeclaration||t)return d.None;const n=e,i=p(n),r=m(n);return i?d.Monobehaviour:r?d.ScriptableObject:d.None}function G(e){const t=e.getSymbol();if(!t)return d.None;const n=t.getDeclarations();if(0===n.length)return d.None;const i=n[0];return U(i,M(i))}function w(e){const t=e.split(a.sep).join("/"),n=t.indexOf("/Assets/");if(-1!==n)return`@assets/${t.substring(n+8)}`;const i=t.match(/\/(com\.genies\.[^\/]+)\//);return i?`@${i[1]}/${t.substring(i.index+i[0].length)}`:null}function j(e,t){return w(a.resolve(e,t))||t}function _(e){return e.getDecorators().map((e=>({Type:e.getName(),Args:e.getArguments().map((e=>e.getText()))})))}t.NumericalAliases=new Set(["byte","sbyte","short","ushort","int","uint","float","double","number"]),function(e){e[e.None=0]="None",e[e.Monobehaviour=1]="Monobehaviour",e[e.ScriptableObject=2]="ScriptableObject"}(d||(t.GeniesScriptType=d={})),t.setProjectRoot=function(e){t.projectRoot=e},t.extendsMonoBehaviour=p,t.extendsScriptableObject=m,t.removeDecorators=function(e,t){const n=t.map((e=>({start:e.getFullStart(),end:e.getEnd()}))).sort(((e,t)=>t.start-e.start));for(const{start:t,end:i}of n)e.replaceText([t,i],"")},t.collectNodes=function e(t,n=0,i=[]){return console.log(t),t.forEachChild((t=>e(t,n+1,i))),i.push({node:t,depth:n}),i},t.traversePostOrder=function e(t,n){t.forEachChild((t=>e(t,n))),n(t)},t.traversePrototypeChain=function(e){const t=new Set;let n=e;for(;n;){const e=x(n.getType());e&&t.add(e),n.getImplements().forEach((e=>{const n=[e.getType()];for(;n.length>0;){const e=n.shift();if(!e)continue;const i=x(e);i&&!t.has(i)&&(t.add(i),e.getBaseTypes().forEach((e=>{n.push(e)})))}})),n=n.getBaseClass()}return Array.from(t)},t.isSignalBusType=function(e){const t=e.getSymbol();return!!t&&"SignalBus"===t.getName()},t.isGeniesEventType=function(e){const t=e.getSymbol();return!!t&&"GeniesEvent"===t.getName()},t.isOrInheritsFromObject=function(e,t){if(!e)return!1;const n=e.getSymbol();return!!n&&(!!["Object"].includes(n.getName())||h(e,["Object"],t))},t.typesAreEqual=y,t.isTypeAssignableTo=function(e,t,n){return!!y(e,t)||void 0!==f(e,n).find((e=>y(e,t)))},t.isOrInheritsFromGameObjectOrComponent=function(e,t){if(!e)return!1;const n=e.getSymbol();return!!n&&(!!["GameObject","Component","MonoBehaviour"].includes(n.getName())||h(e,["GameObject","Component","MonoBehaviour"],t))},t.inheritsFrom=h,t.getBaseTypes=f,t.sortImportsAndVars=function(e){const t=e.getStatements(),n=t.filter((e=>e.getKind()===s.SyntaxKind.ImportDeclaration)),i=t.filter((e=>e.getKind()===s.SyntaxKind.VariableStatement)),r=t.filter((e=>e.getKind()!==s.SyntaxKind.ImportDeclaration&&e.getKind()!==s.SyntaxKind.VariableStatement)),o=[...n.map((e=>e.getText())),"",...i.map((e=>e.getText())),"",...r.map((e=>e.getText()))].join("\n\n");e.replaceWithText(o)},t.createGenericTypeVariable=function e(t,n,i,r){r.sourceFileGenericTypeMap.has(i)||r.sourceFileGenericTypeMap.set(i,new Map);const o=r.sourceFileGenericTypeMap.get(i),a=T(t,n);if(!o.has(a)){const l=S(t),c=n.map((t=>function(t,n,i){return t.getTypeArguments().length>0?e(t,t.getTypeArguments(),n,i):E(t,n)}(t,i,r))),u=`// @ts-ignore \n $generic(${l}, ${c.join(", ")})`,g=`_${a.replace(/\$/g,"_")}`;o.set(a,g),i.addVariableStatement({declarationKind:s.VariableDeclarationKind.Const,declarations:[{name:g,initializer:u}]})}return o.get(a)},t.getGenericTypeKey=T,t.getTypeName=S,t.getTypeNameAndEnsureImported=E,t.getFullTypeName=x,t.extractProperties=v,t.getCompleteTypeArgumentMap=P,t.getIsValidUnityGenericTypeArg=function e(t){if(t.isTypeParameter()){const n=t.getConstraint();return!!n&&e(n)}let n="";const i=t.getAliasSymbol();return n=i?i.getName():t.getText(),!!u.has(n)||G(t)!==d.None||k(t)},t.isUserDefinedType=function(e){const t=e.getSymbol();return!!t&&t.getDeclarations().some((e=>{const t=e.getSourceFile();return(s.Node.isClassLikeDeclarationBase(e)||s.Node.isInterfaceDeclaration(e))&&!t.isFromExternalLibrary()&&!t.isDeclarationFile()}))},t.getIsUnityAPIType=k,t.getTypeByName=function(e,t){const n=t.resolveName(e,void 0,s.SymbolFlags.All,!1);return n?t.getDeclaredTypeOfSymbol(n):void console.log(`Global type '${e}' not found.`)},t.cleanTypeText=K,t.isAssignmentToSymbol=function(e,t){if(s.Node.isPropertyAccessExpression(e)){const n=e.getExpression();if(s.Node.isThisExpression(n))return e.getNameNode().getSymbol()===t}else if(s.Node.isIdentifier(e))return e.getSymbol()===t;return!1},t.getIsUnityAPIDeclaration=M,t.getGeniesScriptTypeFromType=G,t.isGeniesScriptType=function(e){let t=G(e);return t===d.Monobehaviour||t===d.ScriptableObject},t.convertToGeniesAliasPath=w,t.convertToAliasPath=j,t.updateImportsToAliasPaths=function(e){const t=e.getDirectoryPath();e.getImportDeclarations().forEach((e=>{const n=e.getModuleSpecifierValue();if(n.startsWith("./")||n.startsWith("../")){const i=j(t,n);(i.startsWith("@assets/")||i.startsWith("@com.genies"))&&e.setModuleSpecifier(i)}}))}},101:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getNumericValue=t.isNumericCastable=t.selectBestOverload=t.inferPossibleTypes=void 0;const i=n(710),r=n(71);function o(e,t){const n=[],i=t.getTypeAtLocation(e);let o=[];const s=function(e,t){const n=e.getText();if(r.NumericalAliases.has(n)){const e=(0,r.getTypeByName)(n,t);if(e)return e}const i=n.match(/number\s*&\s*\{\s*__([a-zA-Z]+)Brand\?:\s*undefined\s*\}/);if(i){const e=i[1],n=(0,r.getTypeByName)(e,t);if(n)return n}return null}(i,t);if(null!=s)n.push(s);else{const t=c(e);if(void 0!==t)o=function(e){const{value:t,hasDecimal:n}=e,i=new Set;return n?(i.add("float"),i.add("double")):(t>=-2147483648&&t<=2147483647&&i.add("int"),t>=-32768&&t<=32767&&i.add("short"),t>=-128&&t<=127&&i.add("sbyte"),t>=0&&t<=255&&i.add("byte"),t>=0&&t<=65535&&i.add("ushort"),t>=0&&t<=4294967295&&i.add("uint")),Array.from(i)}(t);else{if(a=i,"number"!==(0,r.cleanTypeText)(a.getText()))return n.push(i),n;o=["byte","sbyte","short","ushort","int","uint","float","double"]}}var a;for(const e of o){const i=(0,r.getTypeByName)(e,t);i&&n.push(i)}return n}function s(e,t,n){const i=e.getParameters();if(i.length<t.length)return-1;let r=i.length==t.length?1:0;for(let e=0;e<i.length;e++){const o=n.getTypeAtLocation(i[e]),s=t[e];if(!s||s.length<=0)return-1;const l=a(o,s,n);if(l<0)return-1;r+=l}return r}function a(e,t,n){let i=-1;if(e.isTypeParameter()){const o=e.getConstraint();if(!o)return t.length>0?1:-1;for(const e of t)(0,r.typesAreEqual)(e,o)?i=Math.max(i,2):n.isTypeAssignableTo(e,o)&&(i=Math.max(i,1));return i}if(function(e){const t=(0,r.cleanTypeText)(e.getText());return r.NumericalAliases.has(t)}(e)){for(const n of t)(0,r.typesAreEqual)(n,e)?i=Math.max(i,2):l(n,e)&&(i=Math.max(i,1));return i}for(const o of t)(0,r.typesAreEqual)(o,e)?i=Math.max(i,2):n.isTypeAssignableTo(o,e)&&(i=Math.max(i,1));return i}function l(e,t){var n,i;const o=(0,r.cleanTypeText)(e.getText()),s=(0,r.cleanTypeText)(t.getText());return null!==(i=null===(n={byte:["short","ushort","int","uint","float","double","number"],sbyte:["short","int","float","double","number"],short:["int","float","double","number"],ushort:["int","uint","float","double","number"],int:["float","double","number"],uint:["float","double","number"],float:["double","number"],double:["number"],number:["byte","sbyte","short","ushort","int","uint","float","double"]}[o])||void 0===n?void 0:n.includes(s))&&void 0!==i&&i}function c(e){const t=u(e);if(void 0!==t)return t;if(i.Node.isIdentifier(e)||i.Node.isPropertyAccessExpression(e)){const t=e.getSymbol();if(t){const n=t.getDeclarations();if(n&&n.length>0){const r=n[0];if(i.Node.isVariableDeclaration(r)||i.Node.isPropertyDeclaration(r)){const n=g(t,r,e);if(n)return n}}}}}function u(e){if(i.Node.isNumericLiteral(e)){const t=e.getText();return{value:Number(t),hasDecimal:t.includes(".")}}if(i.Node.isPrefixUnaryExpression(e)&&e.getOperatorToken()===i.SyntaxKind.MinusToken){const t=e.getOperand();if(i.Node.isNumericLiteral(t)){const e=t.getText();return{value:-Number(e),hasDecimal:e.includes(".")}}}}function g(e,t,n){let o;const s=t.getInitializer();if(s){const i=d(s,e,t,n);i&&(o=i)}const a=n.getFirstAncestorByKind(i.SyntaxKind.MethodDeclaration);if(!a)return o;const l=a.getStatements()||[],c=n.getStart();for(const s of l){if(s.getStart()>c)break;{const a=s.getDescendants().filter((e=>i.Node.isBinaryExpression(e)||i.Node.isPrefixUnaryExpression(e)||i.Node.isPostfixUnaryExpression(e)));for(const s of a)if(i.Node.isBinaryExpression(s)){const a=s.getOperatorToken().getKind(),l=s.getLeft(),c=s.getRight();if((0,r.isAssignmentToSymbol)(l,e))if(a===i.SyntaxKind.EqualsToken){o=d(c,e,t,n,o)||void 0}else if([i.SyntaxKind.PlusEqualsToken,i.SyntaxKind.MinusEqualsToken,i.SyntaxKind.AsteriskEqualsToken,i.SyntaxKind.SlashEqualsToken,i.SyntaxKind.PercentEqualsToken].includes(a)){const i=d(c,e,t,n,o);if(i&&o){o=p(a,o,i)||void 0}else o=void 0}}else if(i.Node.isPrefixUnaryExpression(s)||i.Node.isPostfixUnaryExpression(s)){const t=s.getOperatorToken(),n=s.getOperand();if((0,r.isAssignmentToSymbol)(n,e))if(o){let e=t===i.SyntaxKind.PlusPlusToken?1:-1;o={value:o.value+e,hasDecimal:o.hasDecimal}}else o=void 0}}}return o}function d(e,t,n,o,s){if(i.Node.isNumericLiteral(e))return u(e);if(i.Node.isIdentifier(e)||i.Node.isPropertyAccessExpression(e)){if((0,r.isAssignmentToSymbol)(e,t))return s;{const t=e.getSymbol();if(t){const n=t.getDeclarations();if(n&&n.length>0){const r=n[0];if(i.Node.isVariableDeclaration(r)||i.Node.isPropertyDeclaration(r))return g(t,r,e)}}}}else if(i.Node.isBinaryExpression(e)){const i=d(e.getLeft(),t,n,o,s),r=d(e.getRight(),t,n,o,s);if(i&&r)return m(e.getOperatorToken().getKind(),i,r)}}function p(e,t,n){const r={[i.SyntaxKind.PlusEqualsToken]:i.SyntaxKind.PlusToken,[i.SyntaxKind.MinusEqualsToken]:i.SyntaxKind.MinusToken,[i.SyntaxKind.AsteriskEqualsToken]:i.SyntaxKind.AsteriskToken,[i.SyntaxKind.SlashEqualsToken]:i.SyntaxKind.SlashToken,[i.SyntaxKind.PercentEqualsToken]:i.SyntaxKind.PercentToken}[e];if(void 0!==r)return m(r,t,n)}function m(e,t,n){let r,o=t.hasDecimal||n.hasDecimal;switch(e){case i.SyntaxKind.PlusToken:r=t.value+n.value;break;case i.SyntaxKind.MinusToken:r=t.value-n.value;break;case i.SyntaxKind.AsteriskToken:r=t.value*n.value;break;case i.SyntaxKind.SlashToken:r=t.value/n.value,o=!0;break;case i.SyntaxKind.PercentToken:r=t.value%n.value;break;default:return}if(void 0!==r)return{value:r,hasDecimal:o}}t.inferPossibleTypes=o,t.selectBestOverload=function(e,t,n){if(!e||e.length<=0)return;if(1==e.length)return e[0];const i=t.getTypeArguments(),r=i&&i.length>0?function(e,t,n){return e.filter((e=>{const i=e.getTypeParameters();if(!i||0===i.length)return!1;if(t.length!==i.length)return!1;for(let e=0;e<t.length;e++){const r=n.getTypeAtLocation(t[e]),o=i[e].getConstraint();if(o){const e=n.getTypeAtLocation(o);if(!n.isTypeAssignableTo(r,e))return!1}}return!0}))}(e,i,n):e;if(0===r.length)return;if(1===r.length)return r[0];const a=t.getArguments();if(!a||a.length<=0){return r.find((e=>{const t=e.getParameters();return 0===t.length||t.every((e=>e.isOptional()))}))||void 0}const l=t.getArguments().map((e=>o(e,n)));let c,u=-1;for(const e of r){const t=s(e,l,n);t>u&&(u=t,c=e)}return c},t.isNumericCastable=l,t.getNumericValue=c},105:function(e,t,n){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.getGeniesSemanticDiagnostics=void 0;const r=n(710),o=i(n(985)),s=n(71),a=n(101),l=10006,c=new Set(["MonoBehaviour","ScriptableObject"]),u=new Set(["GetComponent","TryGetComponent","GetComponentInChildren","GetComponentsInChildren","GetComponentInParent","GetComponentsInParent","GetComponents","AddComponent"]);function g(e,t,n){return(0,s.isTypeAssignableTo)(e,t,n)}function d(e,t,n,i){const r=t.getStart(),s=t.getWidth(),a={file:t.getSourceFile().compilerNode,start:r,length:s,messageText:n,category:o.default.DiagnosticCategory.Error,code:i,source:"Genies"};e.push(a)}t.getGeniesSemanticDiagnostics=function(e,t){if(!e)return[];const n=[];return function(e,t){e.getClasses().forEach((n=>{var i;const r=n.getBaseClass(),a=n.getImplements(),l=null==r?void 0:r.getName();if(r&&(0,s.getIsUnityAPIType)(r.getType())&&l&&!c.has(l)){const s=r.getStart(),a=null===(i=r.getName())||void 0===i?void 0:i.length,l=`Class '${n.getName()}' inherits from a Unity type '${r.getName()}' that is not 'MonoBehaviour' or 'ScriptableObject'.`,c={file:e.compilerNode,start:s,length:a,messageText:l,category:o.default.DiagnosticCategory.Error,code:10001,source:"Genies"};t.push(c)}a.forEach((i=>{if((0,s.getIsUnityAPIType)(i.getType())){const r=(0,s.getFullTypeName)(i.getType());if(s.AllowedUiInterfaces.has(r))return;const a=i.getStart(),l=i.getWidth(),c=`Class '${n.getName()}' implements a forbidden Unity interface '${i.getText()}'.`,u={file:e.compilerNode,start:a,length:l,messageText:c,category:o.default.DiagnosticCategory.Error,code:10002,source:"Genies"};t.push(u)}}))}))}(e,n),function(e,t,n){e.getDescendantsOfKind(r.SyntaxKind.CallExpression).forEach((e=>{!function(e,t){const n=e.getExpression();let i=[];if(r.Node.isPropertyAccessExpression(n)||r.Node.isIdentifier(n)){const e=n.getSymbol();e&&(i=e.getDeclarations().filter((e=>r.Node.isMethodDeclaration(e))))}if(0===i.length)return;if(!(i.filter((e=>e.getTypeParameters().length>0)).length>0))return;if(i=i.filter((e=>(0,s.getIsUnityAPIDeclaration)(e))),0===i.length)return;const o=function(e){return r.Node.isPropertyAccessExpression(e)?e.getName():r.Node.isIdentifier(e)?e.getText():""}(n);if(function(e,t){const n=t.getArguments().map((e=>e.getType())),i=t.getProject().getTypeChecker();return e.some((e=>{if(e.getTypeParameters().length>0)return!1;const t=e.getParameters();if(t.length!==n.length)return!1;for(let e=0;e<t.length;e++){const r=t[e].getType(),o=n[e];if(!i.isTypeAssignableTo(o,r))return!1}return!0}))}(i,e))return;const a=e.getTypeArguments();if(0===a.length)return void d(t,e,`Generic method '${o}' must be called with type arguments.`,10003);let c=i.map((e=>e.getTypeParameters().length));c.includes(a.length)||d(t,e,`Generic method '${o}' was provided the wrong number of arguments. Valid args counts: '${c.join(", ")}'`,l),u.has(o)?a.forEach((e=>{(function(e){const t=e.getType();if((0,s.getIsValidUnityGenericTypeArg)(t))return!0;if((0,s.getGeniesScriptTypeFromType)(t)===s.GeniesScriptType.Monobehaviour)return!0;const n=t.getSymbol();if(n){const e=n.getDeclarations();if(e&&e.length>0&&r.Node.isInterfaceDeclaration(e[0]))return!0}return!1})(e)||d(t,e,`Type arguments for method '${o}' must be a Unity API type, an interface, or a type that extends MonoBehaviour.`,10004)})):a.forEach((e=>{const n=e.getType();(0,s.getIsValidUnityGenericTypeArg)(n)||d(t,e,`Type arguments for method '${o}' must be Unity API types.`,10004)}))}(e,t),function(e,t,n){var i;const o=e.getExpression();if(!r.Node.isPropertyAccessExpression(o))return;const l=o.asKind(r.SyntaxKind.PropertyAccessExpression),c=null==l?void 0:l.getSymbol();if(!c)return;const u=c.getDeclarations();if(!u||u.length<=0)return;const p=u.filter((e=>r.Node.isMethodDeclaration(e)||r.Node.isMethodSignature(e)));if(0===p.length)return;const m=p[0];if(!(0,s.getIsUnityAPIDeclaration)(m))return;const y=(0,a.selectBestOverload)(p,e,n);if(!y)return;const h=y.getParameters(),f=e.getArguments(),T=e.getTypeArguments(),S=y.getTypeParameters(),E=T&&T.length>0&&S&&S.length>0,x=new Map;if(E)for(let e=0;e<Math.min(T.length,S.length);e++)x.set(S[e].getName(),n.getTypeAtLocation(T[e]));for(let e=0;e<Math.min(h.length,f.length);e++){const r=h[e],o=f[e];let a=r.getType();const l=o.getType();if((0,s.isUserDefinedType)(l)){if(a.isTypeParameter()){const e=null===(i=a.getSymbol())||void 0===i?void 0:i.getName();e&&x.has(e)?a=x.get(e):a.getConstraint()&&(a=a.getConstraint())}g(l,a,n)||d(t,o,`Argument of type '${(0,s.getFullTypeName)(l)}' is not assignable to parameter of type '${(0,s.getFullTypeName)(a)}'.`,10008)}}}(e,t,n)}))}(e,n,t),function(e,t){e.getDescendantsOfKind(r.SyntaxKind.NewExpression).forEach((e=>{const n=e.getType().getSymbol();if(!n)return;const i=n.getDeclarations();if(!i||0===i.length)return;const o=i.filter((e=>r.Node.isClassDeclaration(e)&&(0,s.getIsUnityAPIDeclaration)(e)&&e.getTypeParameters().length>0));if(0===o.length)return;const a=o[0].getTypeParameters().length,c=e.getTypeArguments(),u=c.length;0===u?d(t,e,`Generic class '${(0,s.getFullTypeName)(e.getType())}' must be instantiated with ${a} type argument(s).`,10005):(u!==a&&d(t,e,`Generic class '${(0,s.getFullTypeName)(e.getType())}' expects ${a} type argument(s), but got ${u}.`,l),c.forEach((n=>{const i=n.getType();(0,s.getIsValidUnityGenericTypeArg)(i)||d(t,n,`Type arguments for type '${(0,s.getFullTypeName)(e.getType())}' must be Unity API types.`,l)})))}))}(e,n),n}},130:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getOperatorNodeReturnType=t.getUnaryOperatorMethodReturnType=t.getEquivalentOperatorForCompound=t.isCompoundAssignment=t.unwrapParenthesizedExpression=t.getOperatorMethodName=t.getOperatorMethodReturnType=void 0;const i=n(710),r=n(71);function o(e,t,n,o){const s=t.getSymbol();if(!s)return null;const a=s.getDeclarations();for(const s of a)if(i.Node.isClassDeclaration(s)){const i=s.getMethods().filter((e=>e.getName()===n&&0===e.getTypeParameters().length));for(const n of i){const i=n.getParameters();if(2===i.length){const s=i[0].getType(),a=i[1].getType(),l=(0,r.typesAreEqual)(a,o)||e.isTypeAssignableTo(o,a);if(((0,r.typesAreEqual)(s,t)||e.isTypeAssignableTo(t,s))&&l)return n.getReturnType()}}}return null}function s(e,t=!1){if(t)switch(e){case i.SyntaxKind.MinusToken:return"op_UnaryNegation";case i.SyntaxKind.PlusToken:return"op_UnaryPlus";case i.SyntaxKind.ExclamationToken:return"op_LogicalNot";case i.SyntaxKind.TildeToken:return"op_OnesComplement";case i.SyntaxKind.PlusPlusToken:return"op_Increment";case i.SyntaxKind.MinusMinusToken:return"op_Decrement";default:return}else switch(e){case i.SyntaxKind.PlusToken:return"op_Addition";case i.SyntaxKind.MinusToken:return"op_Subtraction";case i.SyntaxKind.AsteriskToken:return"op_Multiply";case i.SyntaxKind.SlashToken:return"op_Division";case i.SyntaxKind.PercentToken:return"op_Modulus";case i.SyntaxKind.EqualsEqualsToken:case i.SyntaxKind.EqualsEqualsEqualsToken:return"op_Equality";case i.SyntaxKind.ExclamationEqualsToken:case i.SyntaxKind.ExclamationEqualsEqualsToken:return"op_Inequality";case i.SyntaxKind.GreaterThanToken:return"op_GreaterThan";case i.SyntaxKind.LessThanToken:return"op_LessThan";case i.SyntaxKind.GreaterThanEqualsToken:return"op_GreaterThanOrEqual";case i.SyntaxKind.LessThanEqualsToken:return"op_LessThanOrEqual";case i.SyntaxKind.BarToken:return"op_BitwiseOr";case i.SyntaxKind.AmpersandToken:return"op_BitwiseAnd";case i.SyntaxKind.CaretToken:return"op_ExclusiveOr";case i.SyntaxKind.LessThanLessThanToken:return"op_LeftShift";case i.SyntaxKind.GreaterThanGreaterThanToken:return"op_RightShift";default:return}}function a(e){return i.Node.isParenthesizedExpression(e)?a(e.getExpression()):e}function l(e){return e>=i.SyntaxKind.FirstCompoundAssignment&&e<=i.SyntaxKind.LastCompoundAssignment}function c(e){switch(e){case i.SyntaxKind.PlusEqualsToken:return i.SyntaxKind.PlusToken;case i.SyntaxKind.MinusEqualsToken:return i.SyntaxKind.MinusToken;case i.SyntaxKind.AsteriskEqualsToken:return i.SyntaxKind.AsteriskToken;case i.SyntaxKind.SlashEqualsToken:return i.SyntaxKind.SlashToken;case i.SyntaxKind.PercentEqualsToken:return i.SyntaxKind.PercentToken;case i.SyntaxKind.AmpersandEqualsToken:return i.SyntaxKind.AmpersandToken;case i.SyntaxKind.BarEqualsToken:return i.SyntaxKind.BarToken;case i.SyntaxKind.CaretEqualsToken:return i.SyntaxKind.CaretToken;case i.SyntaxKind.LessThanLessThanEqualsToken:return i.SyntaxKind.LessThanLessThanToken;case i.SyntaxKind.GreaterThanGreaterThanEqualsToken:return i.SyntaxKind.GreaterThanGreaterThanToken;case i.SyntaxKind.GreaterThanGreaterThanGreaterThanEqualsToken:return i.SyntaxKind.GreaterThanGreaterThanGreaterThanToken;default:throw new Error(`Unsupported compound operator: ${i.SyntaxKind[e]}`)}}function u(e,t){const n=e.getSymbol();if(!n)return null;const r=n.getDeclarations();for(const n of r)if(i.Node.isClassDeclaration(n)){const i=n.getMethods().filter((e=>e.getName()===t&&0===e.getTypeParameters().length));for(const t of i){const n=t.getParameters();if(1===n.length&&n[0].getType().getText()===e.getText())return t.getReturnType()}}return null}function g(e,t){return i.Node.isBinaryExpression(e)?d(e,t):i.Node.isPrefixUnaryExpression(e)||i.Node.isPostfixUnaryExpression(e)?p(e,t):t.TypeChecker.getTypeAtLocation(e)}function d(e,t){const n=e.getOperatorToken().getKind();let u=s(n);if(l(n)&&(u=s(c(n))),null==u)return null;if(n===i.SyntaxKind.EqualsEqualsEqualsToken||n===i.SyntaxKind.EqualsEqualsToken||n===i.SyntaxKind.ExclamationEqualsEqualsToken||n==i.SyntaxKind.ExclamationEqualsToken){const t=a(e.getRight());if(i.Node.isNullLiteral(t)||i.Node.isUndefinedKeyword(t))return null;const n=a(e.getLeft());if(i.Node.isNullLiteral(n)||i.Node.isUndefinedKeyword(n))return null}const d=a(e.getLeft()),p=a(e.getRight());let m=g(d,t),y=g(p,t);if(null==m||null==y)return null;if(y.isLiteral()&&(y=t.TypeChecker.getBaseTypeOfLiteralType(y)),m.isLiteral()&&(m=t.TypeChecker.getBaseTypeOfLiteralType(m)),!(0,r.getIsUnityAPIType)(m)&&!(0,r.getIsUnityAPIType)(y))return t.TypeChecker.getTypeAtLocation(e);const h=o(t.TypeChecker,m,u,y),f=o(t.TypeChecker,y,u,m);if(null==h&&null==f)return null;if(l(n)){const e=s(c(n));return null==e?null:o(t.TypeChecker,m,e,y)}return null!=h?h:f}function p(e,t){const n=a(e.getOperand()),i=s(e.getOperatorToken(),!0);return i?u(t.TypeChecker.getTypeAtLocation(n),i):null}t.getOperatorMethodReturnType=o,t.getOperatorMethodName=s,t.unwrapParenthesizedExpression=a,t.isCompoundAssignment=l,t.getEquivalentOperatorForCompound=c,t.getUnaryOperatorMethodReturnType=u,t.getOperatorNodeReturnType=function(e,t){return i.Node.isBinaryExpression(e)?d(e,t):i.Node.isPrefixUnaryExpression(e)||i.Node.isPostfixUnaryExpression(e)?p(e,t):null}},335:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.GeniesLSPContext=void 0,t.GeniesLSPContext=class{constructor(e,t){this.project=e,this.info=t,this.inferredTypesCache=new Map}get LanguageServiceHost(){return this.info.languageServiceHost}get LanguageService(){return this.info.languageService}get Logger(){return this.info.project.projectService.logger}get TypeChecker(){return this.project.getTypeChecker()}getSourceFile(e){let t=this.project.getSourceFile(e);const n=this.getInMemoryFileContent(e,this.info.languageServiceHost);if(t)n?t.replaceWithText(n):t.refreshFromFileSystemSync();else if(t=n?this.project.createSourceFile(e,n,{overwrite:!0}):this.project.addSourceFileAtPath(e),!t)return void this.Logger.info("Source file not found.");return t}getInMemoryFileContent(e,t){const n=t.getScriptSnapshot(e);return n?n.getText(0,n.getLength()):void 0}setInferredType(e,t){this.inferredTypesCache.set(e,t)}getInferredType(e){return this.inferredTypesCache.get(e)}clearInferredTypes(){this.inferredTypesCache.clear()}}},400:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.GeniesScriptTypeDiagnostics=void 0;const i=n(71);t.GeniesScriptTypeDiagnostics=class{constructor(e){this.context=e}get Logger(){return this.context.Logger}enhanceProxy(e){const t=e.getSuggestionDiagnostics;e.getSuggestionDiagnostics=e=>{const n=t(e);return this.getSuggestionDiagnostics(n,e)}}getSuggestionDiagnostics(e,t){const n=this.context.getSourceFile(t);return n?(n.getClasses().filter((e=>(0,i.isGeniesScriptType)(e.getType()))).forEach((t=>{e.filter((e=>(this.Logger.info(`found class ${t.getName()} with range ${t.getStart()} - ${t.getEnd()}`),this.Logger.info(`Code = ${e.code}`),this.Logger.info(`Diagnostic start = ${e.start}`),this.Logger.info(`Diagnostic Message = ${e.messageText}`),6196===e.code&&e.start>=t.getStart()&&e.start<=t.getEnd()))).forEach((t=>{const n=e.indexOf(t);n>-1&&e.splice(n,1)}))})),e):e}}},710:e=>{e.exports=require("ts-morph")},741:function(e,t,n){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.GeniesLifecycleEventsCompletions=void 0;const r=i(n(985)),o=n(710),s=n(71),a=n(60);t.GeniesLifecycleEventsCompletions=class{constructor(e){this.context=e}get Logger(){return this.context.Logger}enhanceProxy(e){const t=e.getCompletionsAtPosition;e.getCompletionsAtPosition=(e,n,i)=>this.getCompletionsAtPosition(t,e,n,i);const n=e.getCompletionEntryDetails;e.getCompletionEntryDetails=(e,t,i,r,o,s,a)=>this.getCompletionEntryDetails(n,e,t,i,r,o,s,a)}getCompletionsAtPosition(e,t,n,i){var o,s,l,c;this.Logger.info("Getting completions at position.");const u=e(t,n,i),g=[],d=this.context.getSourceFile(t);if(!d)return u;const p=null!==(o=null==u?void 0:u.entries.filter((e=>!a.unityLifecycleMethods.find((t=>t.name===e.name)))))&&void 0!==o?o:[],m=this.getRelevantMethods(d,n);return m&&g.push(...m.map((e=>{const t=`private ${e.name}(${e.parameters}) {\n${e.description}\t$0\n}`;return{name:e.name,kind:r.default.ScriptElementKind.memberFunctionElement,kindModifiers:"private",sortText:"0",insertText:t,labelDetails:{description:e.description},isSnippet:!0,hasAction:!0}}))),this.Logger.info("Adding completions for Unity lifecycle methods."),{isGlobalCompletion:null!==(s=null==u?void 0:u.isGlobalCompletion)&&void 0!==s&&s,isMemberCompletion:null!==(l=null==u?void 0:u.isMemberCompletion)&&void 0!==l&&l,isNewIdentifierLocation:null!==(c=null==u?void 0:u.isNewIdentifierLocation)&&void 0!==c&&c,entries:[...null!=p?p:[],...g]}}getCompletionEntryDetails(e,t,n,i,o,s,a,l){const c=e(t,n,i,o,s,a,l);if(c)return c;const u=this.context.getSourceFile(t);if(!u)return c;const g=this.getRelevantMethods(u,n);if(!g)return c;const d=g.find((e=>e.name===i));if(d){const e=[{text:"private",kind:"keyword"},{text:" ",kind:"space"},{text:d.name,kind:"methodName"},{text:"(",kind:"punctuation"}];if(d.parameters){const t=d.parameters.split(",").map((e=>e.trim()));for(let n=0;n<t.length;n++){const[i,r]=t[n].split(":").map((e=>e.trim()));e.push({text:i,kind:"parameterName"}),e.push({text:": ",kind:"punctuation"}),e.push({text:r,kind:"type"}),n<t.length-1&&e.push({text:", ",kind:"punctuation"})}}e.push({text:")",kind:"punctuation"}),e.push({text:" ",kind:"space"});const t=this.createImportChanges(u,d.imports);return{name:d.name,kind:r.default.ScriptElementKind.memberFunctionElement,kindModifiers:"private",displayParts:e,documentation:[{text:d.description,kind:"text"}],tags:[],codeActions:t.length>0?[{description:`Add necessary imports for ${d.name}`,changes:t}]:void 0}}}createImportChanges(e,t){const n=[],i=new Map;return e.getImportDeclarations().forEach((e=>{const t=e.getModuleSpecifierValue(),n=new Set(e.getNamedImports().map((e=>e.getName())));i.set(t,n)})),t.forEach((e=>{const t=i.get(e.module);t?t.has(e.type)||t.add(e.type):i.set(e.module,new Set([e.type]))})),i.forEach(((t,i)=>{const r=e.getImportDeclaration(i);if(r){const i=r.getNamedImports().map((e=>e.getName())),o=Array.from(t).filter((e=>!i.includes(e)));if(o.length>0){const t=r.getNamedImports().pop();t&&n.push({fileName:e.getFilePath(),textChanges:[{newText:`, ${o.join(", ")}`,span:{start:t.getEnd(),length:0}}]})}}else n.push({fileName:e.getFilePath(),textChanges:[{newText:`import { ${Array.from(t).join(", ")} } from '${i}';\n`,span:{start:0,length:0}}]})})),n}getRelevantMethods(e,t){const n=e.getDescendantAtPos(t);if(n){const e=this.getEnclosingClassDeclaration(n,t);if(e){if(!this.isPositionInClassBodyOnly(e,t))return;const n=e.getType(),i=(0,s.getGeniesScriptTypeFromType)(n);if(i===s.GeniesScriptType.None)return void this.Logger.info("No relevant methods found for the script type.");const r=e.getMethods().map((e=>e.getName())),o=a.unityLifecycleMethods.filter((e=>!r.includes(e.name)));let l=[];return i===s.GeniesScriptType.Monobehaviour?l=o:i===s.GeniesScriptType.ScriptableObject&&(l=o.filter((e=>a.ScriptableObjectAllowedMethods.includes(e.name)))),l}}}getEnclosingClassDeclaration(e,t){let n=e;for(;n;){if(o.Node.isClassDeclaration(n)){const e=n.getStart(),i=n.getEnd();if(e<=t&&t<=i)return n}n=n.getParent()}}isPositionInClassBodyOnly(e,t){const n=e.getFirstChildByKind(o.SyntaxKind.OpenBraceToken),i=e.getFirstChildByKind(o.SyntaxKind.CloseBraceToken);if(!n||!i)return!1;const r=n.getEnd(),s=i.getStart();if(t<r||t>s)return!1;const a=e.getSourceFile().getDescendantAtPos(t);if(!a)return!1;const l=a.getParent(),c=null==l?void 0:l.getParent();return l===e||l===n||l===i||c===e}}},830:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.GeniesLifecycleEventsDiagnostics=void 0;const i=n(60),r=n(71);t.GeniesLifecycleEventsDiagnostics=class{constructor(e){this.context=e}get Logger(){return this.context.Logger}enhanceProxy(e){const t=e.getSuggestionDiagnostics;e.getSuggestionDiagnostics=e=>{const n=t(e);return this.getSuggestionDiagnostics(n,e)}}getSuggestionDiagnostics(e,t){const n=this.context.getSourceFile(t);if(!n)return e;const o=new Set(i.unityLifecycleMethods.map((e=>e.name)));return n.getClasses().filter((e=>(0,r.isGeniesScriptType)(e.getType()))).flatMap((e=>e.getMethods())).filter((e=>o.has(e.getName()))).forEach((t=>{e.filter((e=>6133===e.code&&e.start===t.getNameNode().getStart())).forEach((t=>{const n=e.indexOf(t);n>-1&&e.splice(n,1)}))})),e}}},865:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.GeniesSemanticDiagnostics=void 0;const i=n(105);t.GeniesSemanticDiagnostics=class{constructor(e){this.context=e}get Logger(){return this.context.Logger}enhanceProxy(e){const t=e.getSemanticDiagnostics;e.getSemanticDiagnostics=e=>{let n=t(e);return n=this.getGeniesSemanticDiagnostics(n,e),n}}getGeniesSemanticDiagnostics(e,t){const n=this.context.getSourceFile(t);if(!n)return e;const r=(0,i.getGeniesSemanticDiagnostics)(n,this.context.TypeChecker);return[...e.filter((e=>!r.some((t=>t.messageText===e.messageText&&t.start===e.start&&t.length===e.length)))),...r]}}},928:e=>{e.exports=require("path")},985:e=>{e.exports=require("typescript/lib/tsserverlibrary")}},t={};return function n(i){var r=t[i];if(void 0!==r)return r.exports;var o=t[i]={exports:{}};return e[i].call(o.exports,o,o.exports,n),o.exports}(26)})()));
//# sourceMappingURL=index.js.map